---
title: "WORD ACQUISITION OF INFANTS AND TODDLERS"
output: html_document
---
## Hypotheses

This study has 2 hypotheses to prove. 

First of them is that children memorize words of closed class after acquisition of particular amount of words from opened class. In this paper we tried to prove that toddlers assimilate nouns earlier than verbs and adjectives, when closed class items are scarcer in their speech.

The author could also expect that frequency of each category in child directed speech and adults’ speech have linear negative association with age of acquisition of each word class. A general idea of connection between these factors is that frequencies of each reproduced group of words could be the highest when children are the youngest. During their growing up children commence to remember and reproduce rarer classes of words. It is the second hypothesis of the study hereto.

## Description of the data

### Data collection method

The main data consists of 732 words included in the Norwegian adaptation of MacArthur-Bates Communicative Development Inventories (abbreviated as "CDI") form, a parental questionnaire demonstrated to give a valid and reliable measure of early lexical development. The Norwegian CDI norms consist of averaged data from 6500 monolingual Norwegian children. Important thing about CDI: their norms are typically cross-sectional and can thus not be used to determine when each child acquired each word, only which words she or he currently produces (or understands). This limitation was circumvented by calculating the age in months where at least 50% of the children are reported to produce each word. It is commonly referred to the data as a word’s age of acquisition. 

This data was collected by Pernille Hansen, PhD in linguistics at MultiLing, University of Oslo.

### Description of the data

The dataset includes two files. The main table consists of information about 732 Norwegian words with translation into English, age of acquisition and vocabulary size reproduced by more that 50% of children when they learn words, lexical and broad lexical categories of each word and frequencies of words in the Norwegian Web Corpus, which is used to evaluate frequencies of words in adults' speech, and child-directed speech (abbreviated as "CDS"). The "Norwegian CDS frequency" table replicates some columns from main data. The second table includes measures of how frequently each word is used in Norwegian both on the internet (as observed in the Norwegian Web as Corpus dataset) and when an adult is talking to a child. It is a reason why the author of the piece of research explore only the first file.

### Main data columns

* __ID_CDI_I__ (ID in the Norwegian CDI I (Kristoffersen et al. 2012));

* __ID_CDI_II__ (ID in the Norwegian CDI II (Kristoffersen et al. 2012));

* __Word_NW__ (Entry as given in the database Norwegian Words (Lind et al, 2015));

* __Word_CDI__ (Entry as given in the CDI (Kristoffersen et al. 2012));

* __Translation__ (English translation of each word);

* __AoA__ (Age of acquisition: the age (in months) where 50% of the norming sample of children (Simonsen et al., 2014) are reported to produce the word);

* __VSoA__ (Vocabulary size of acquisition: the vocabulary size (in spans of 20 words) where 50% of the norming sample of children (Simonsen et al., 2014) are reported to produce the word);

* __Lex_cat__ (Lexical category as given by Kristoffersen et al. (2012));

* __Broad_lex__ (Broad lexical category based on Bates et al. (1994));

* __Freq__ (Frequency in the corpus Norwegian Web as Corpus (NoWaC) (Guevara 2010), taken to approximate frequency in adult speech);

* __CDS_freq__ (Frequency in child-directed speech based Simonsen (1990) and Garmann-Norwegian (Garmann, 2016; Garmann et al., in press)).

### Main factors

In the current dataset nouns are named as *common nouns*, *places to go*, *people* (in __Lex_cat__) and *nominals* (in __Broad_lex__). Some nouns are included in *games&routines* (both in __Lex_cat__ and __Broad_lex__), which also consists of interjections ('ja' - 'yes', 'nei' - 'no','hallo' - 'hello'), verbs ('vent' - 'wait') and constructions ('gå på do' - 'go to the bathroom', 'god natt' - 'good night'). 

As a broad category, *nominals* comprise some interjections as *sound effects*(in __Lex_cat__).

Most of all verbs are placed into *action words* category (in __Lex_cat__) and *predicates* (in __Broad_lex__). Furthermore, it is important to notice that adjectives are included in *predicates* (in __Broad_lex__) group, but they are named as *descriptive words* (in __Lex_cat__).

Closed class words are represented in *closed-class items* (in __Lex_cat__), or *closed-class* (in __Broad_lex__).

There appears to be *temporal* category which is not identified in the main data ('#N/A' category). It is composed of temporal nouns, prepositions and adverbs such as 'formiddag' -  'morning', 'nå' - 'now' and 'senere' - 'later'.

According to this information, the author decided to analyze *common nouns*, *places to go* and *people* as nouns, *action words* as verbs, *descriptive words* as adjectives and *closed-class items* as closed class words. The reason of this choice is that mixed categories are able to confuse models and results. Additional relevant factors for the paper are frequencies of words in adults’ and child directes speech and age of each word's reproducing.

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
#словарик
# outliers - выбросы
# the study hereto - эта работа
# novelty - новизна
# The scope of the study - масштаб, сфера, объем работы

#assume, deny, promise, refuse, suggest
#ascertain, assert
#anticipated - ожидаемый
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
install.packages('tidyverse')
install.packages('imputeTS')
install.packages('Hmisc')
install.packages('car')
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(imputeTS)
library(ggplot2)
library(dplyr)
library(car)
main_data <- read_csv('https://raw.githubusercontent.com/wksmirnowa/LDA_project/master/main_data.csv')
head(main_data)
```

## Preprocessing

The data have missing values. First, we should rename gaps in lexical categories. '#N/A' strings there are located in rows with temporal nouns and prepositions, for instance, 'morgen' ('morning'), 'før' ('before').

```{r}
main_data$Lex_cat <- gsub('#N/A', 'temporal', main_data$Lex_cat)
main_data$Lex_cat <- as.factor(main_data$Lex_cat)
main_data$Broad_lex <- gsub('#N/A', 'temporal', main_data$Broad_lex)
main_data$Broad_lex <- as.factor(main_data$Broad_lex)
main_data$Word_CDI <- as.factor(main_data$Word_CDI)
```

Missing values could be observed in columns with numeric content. It is necessary to remove them.

```{r, message=FALSE, warning=FALSE, include=TRUE}
main_data$AoA <- as.numeric(main_data$AoA)
main_data$VSoA <- as.numeric(main_data$VSoA)
main_data$CDS_freq <- as.numeric(main_data$CDS_freq)
main_data$Freq <- as.numeric(main_data$Freq)
main_data<-na.omit(main_data)
```

## Visualisation of the data

On the graphs below quantities of lexical and broad lexical categories are represented.

```{r}
main_data %>%
ggplot(aes(Broad_lex, fill=Broad_lex))+geom_bar()+
        labs(title = "Broad lexical categories: amount of words",
             x = "broad lexical category")+scale_fill_discrete("Broad lexical categories")
```


```{r}
par(mar=c(7,7,1,1)+3.5,mgp=c(6,1,0))
main_data %>%
ggplot(aes(Lex_cat, fill=Lex_cat))+geom_bar()+
        labs(title = "Lexical categories: amount of words",
             x = "lexical category")+scale_fill_discrete("Lexical categories")+
  theme(plot.margin = margin(1, 0, 1, 0))
```

We are able to notice some outliers in the dataset.

```{r}
length(boxplot(main_data$AoA ~ main_data$Broad_lex, 
        main = "Age of acquisition ~ broad lexical category",
        xlab = "broad lexical category",
        ylab = "age in months",
        col = "pink",
        border = "brown")$out)

```

```{r}
length(boxplot(main_data$AoA ~ main_data$Lex_cat, 
        main = "Age of acquisition ~ lexical category",
        xlab = "lexical category",
        ylab = "age in months",
        col = "pink",
        border = "brown")$out)

```

The diagrams below demonstrate outliers (words from which categories children reproduce earlier or later than significant majority of the studied words) separated by categories.

```{r}
p <- ggplot(main_data, aes(Broad_lex, AoA, color=Broad_lex)) 
p + geom_boxplot() + facet_wrap(~Broad_lex, scale="free") + 
        labs(title = "Age of acquisition ~ broad lexical category",
       x = "broad lexical category",
       y = "age in months") + scale_colour_discrete("Broad lexical categories")
```

```{r}
p <- ggplot(main_data, aes(Lex_cat, AoA, color=Lex_cat)) 
p + geom_boxplot() + facet_wrap(~Lex_cat, scale="free") + 
        labs(title = "Age of acquisition ~ lexical category",
       x = "lexical category",
       y = "age in months") + scale_colour_discrete("Lexical categories")
```

The pictures below provide general information about each learned word and age of its acquisition. Every point means a word.

```{r}
ggplot(data = main_data, aes(x = Word_CDI, y = AoA, col=Broad_lex)) + 
  geom_point() +
  labs(x = "words",
       y = "age in months",
       title = "Words")+scale_colour_discrete("Broad lex categories")
```

```{r}
ggplot(data = main_data, aes(x = Word_CDI, y = AoA, col=Lex_cat)) + 
  geom_point() +
  labs(x = "words",
       y = "age in months",
       title = "Words")+scale_colour_discrete("Lexical categories")
```

```{r}
ggplot(data = main_data, aes(x = Broad_lex, y = AoA, col=Broad_lex)) + 
  geom_point() +
  labs(x = "broad lexical category",
       y = "age in months",
       title = "Words")+scale_colour_discrete("Broad lexical categories")
```
```{r}
ggplot(data = main_data, aes(x = Lex_cat, y = AoA, col=Lex_cat)) + 
  geom_point() +
  labs(x = "lexical category",
       y = "age in months",
       title = "Words")+ scale_colour_discrete("Lexical categories")
```

## Statistical hypotheses to prove

The main hypotheses of the piece of research are:

* children commence to reproduce words of closed class after acquisition of nouns, verbs and adjectives;

* frequency of words in child directed speech and adults’ speech within some classes have strong correlation with age of acquisition. 

The statistical hypotheses based on the linguistic ones are:

__First__

* __H0__: ages of acquisition of different classes are similar.
* __H1__: ages of acquisition of different classes have variations.

__Second__

* __H0__: there appears to be no correlation between frequencies of categories in parents’ speech and age of words' acquisition, the true correlation Pearson's coefficient is 0.
* __H1__: there appears to be correlation between frequencies of categories in parents’ speech and age of words' acquisition, the true correlation Pearson's coefficient is not 0.

__Third__

* __H0__: there appears to be no linear (negative or positive) association between frequencies of categories in parents’ speech and age of words' acquisition.
* __H1__: there appears to be linear (negative or positive) association between frequencies of categories in parents’ speech and age of words' acquisition.

Both second and third hypotheses are connected with the second task of the study.

## Statistical tools and methods

__First__

The author of the study hereto assert the first hypotheses with analysis of variance (*ANOVA*) method. *ANOVA* permits to show connections between more than 2 groups which is benefit for our main factors - parts of speech.

The second hypothesis is examined on *Pearson's correlation coefficient*. As we could observe above, the data have small amount of outliers and tied values, so it appears to be the most suitable evaluation of connection between word frequencies and age.

We decide to use *linear regression* for understanding and analyzing if the connection exists and how strong it is.

### Connection between part of speech and age (ANOVA)

#### Preprocessing for the first part

```{r}
main_data %>% filter(Lex_cat=="action words")-> verbs
main_data %>% filter(Lex_cat=="descriptive words")-> adjectives
main_data %>% filter(Broad_lex=="closed-class")-> closedclass

main_data %>% filter(Lex_cat=="common nouns")-> common_nouns
main_data %>% filter(Lex_cat=="places to go")-> places_to_go
main_data %>% filter(Lex_cat=="people")-> people

bind_rows(common_nouns, places_to_go, people) -> nouns
bind_rows(nouns, verbs, adjectives, closedclass) -> target_cats

head(target_cats)
```

#### First attempt with suggested categories

```{r}
categories_acquisition <- aov(target_cats$AoA ~ target_cats$Lex_cat)
categories_acquisition
summary(categories_acquisition)
```

The p-value (<2e-16) for F statistics is less than our significance level, so we reject the null hypothesis. Mean ages of acquisition of different classes are not the same. We could check confidence values to visualise them.

```{r}
tukey <- TukeyHSD(x=categories_acquisition, conf.level=0.95)
tukey
```

```{r}
par(mar=c(1,7,1,1)+3.5,mgp=c(6,1,0))
plot(tukey, las=1, col="brown", cex.lab=2.5, cex.axis=0.7)
```

As we could notice at the diagram, some categories have not significant differences in age of learning: *common nouns-action words*, *descriptive words-action words*, *places to go-action words*, *people-common nouns*, *people-descriptive words*, *places to go-descriptive words* and *places to go-people*. *people-common nouns* and *places to go-people* could be explained by the fact that all words from that groups are nouns. But *common nouns-action words*, *descriptive words-action words*, *places to go-action words*, *people-descriptive words* and *places to go-descriptive words* are interesting cases because words from that pairs belong to different parts of speech. We could assume that in some cases part of speech or lexical category of some words do not influence age of reproducing that words.

#### Preprocessing for the second part

Estimates of **Main factors** part, some categories of words should be renamed for further analysis.

```{r}
main_data <- read_csv('https://raw.githubusercontent.com/wksmirnowa/LDA_project/master/main_data.csv')
main_data$Lex_cat <- gsub('#N/A', 'temporal', main_data$Lex_cat)
main_data$Broad_lex <- gsub('#N/A', 'temporal', main_data$Broad_lex)
main_data$Word_CDI <- as.factor(main_data$Word_CDI)
main_data$Lex_cat <- gsub('action words', 'verbs', main_data$Lex_cat)
main_data$Lex_cat <- gsub('descriptive words', 'adjectives', main_data$Lex_cat)
main_data$Lex_cat <- gsub('closed-class items', 'closedclass', main_data$Lex_cat)
main_data$Lex_cat <- gsub('common nouns', 'nouns', main_data$Lex_cat)
main_data$Lex_cat <- gsub('places to go', 'nouns', main_data$Lex_cat)
main_data$Lex_cat <- gsub('people', 'nouns', main_data$Lex_cat)

main_data$Broad_lex <- as.factor(main_data$Broad_lex)
main_data$Lex_cat <- as.factor(main_data$Lex_cat)
```

```{r, message=FALSE, warning=FALSE, include=TRUE}
main_data$AoA <- as.numeric(main_data$AoA)
main_data$VSoA <- as.numeric(main_data$VSoA)
main_data$CDS_freq <- as.numeric(main_data$CDS_freq)
main_data$Freq <- as.numeric(main_data$Freq)
main_data<-na.omit(main_data)
```

```{r}
main_data %>% filter(Lex_cat=="verbs")-> verbs
main_data %>% filter(Lex_cat=="adjectives")-> adjectives
main_data %>% filter(Lex_cat=="closedclass")-> closedclass
main_data %>% filter(Lex_cat=="nouns")-> nouns

bind_rows(nouns, verbs, adjectives, closedclass) -> target_cats_new
head(target_cats_new)
```

#### Second attempt with parts of speech

```{r}
categories_acquisition <- aov(target_cats_new$AoA ~ target_cats_new$Lex_cat)
categories_acquisition
summary(categories_acquisition)
```

The p-value (<2e-16) for F statistics is same. It is still less than our significance level, so we reject the null hypothesis again. Mean ages of acquisition of different classes are not the same.

```{r}
tukey <- TukeyHSD(x=categories_acquisition, conf.level=0.95)
tukey
```

```{r}
par(mar=c(1,7,1,1)+3.5,mgp=c(6,1,0))
plot(tukey , las=1 , col="brown")
```

Both pictures of TukeyHSD plot show notable differences between mean values of POS pairs. 

On the first graph 

On the second graph *verbs-nouns* and *verbs-adjectives* intervals cross the 0 line. It shows that difference between that parts of speech is less statistical significant, than differences between other pairs of categories.


Результаты парных сравнений методом Tukey показывают доверительные интервалы для разницы средних значений. Таким образом, на графике вы видите не средние значения, а разницу между парами средних значений: nouns-adjectives, verbs-adjectives, verbs-nouns. Это, в свою очередь, позволяет судить о различии средних значений.

Если интервал не содержит нуль, существует статистически значимая разница между соответствующими средними значениями. Чем дальше результат от нуля, тем большая разница между средними значениями.
Если же интервал содержит нуль, разница между средними значениями не является статистически значимой.

```{r}

pd = position_dodge(0.4)
ggplot(target_cats_new, aes(Lex_cat, AoA, color = Lex_cat)) + 
    stat_summary(fun.data = mean_cl_boot, geom = 'errorbar', width = 0.2, lwd = 0.8, position = pd)+ 
    stat_summary(fun.data = mean_cl_boot, geom = 'line', size = 1.5, position = pd) +
    stat_summary(fun.data = mean_cl_boot, geom = 'point', size = 5, position = pd, pch=15) +
    theme_bw() + 
   ggtitle("POS/category acquisition")+
    xlab('POS/category')+
    ylab('age in months') + scale_colour_discrete("POS/category")

```

### Linear regression

#### Preprocessing

```{r}
main_data <- read_csv('https://raw.githubusercontent.com/wksmirnowa/LDA_project/master/main_data.csv')
main_data$Lex_cat <- gsub('#N/A', 'temporal', main_data$Lex_cat)
main_data$Broad_lex <- gsub('#N/A', 'temporal', main_data$Broad_lex)
main_data$Word_CDI <- as.factor(main_data$Word_CDI)
main_data$Lex_cat <- gsub('action words', 'verbs', main_data$Lex_cat)
main_data$Lex_cat <- gsub('descriptive words', 'adjectives', main_data$Lex_cat)
main_data$Lex_cat <- gsub('closed-class items', 'closedclass', main_data$Lex_cat)

main_data$Lex_cat <- gsub('common nouns', 'nouns', main_data$Lex_cat)
main_data$Lex_cat <- gsub('places to go', 'nouns', main_data$Lex_cat)
main_data$Lex_cat <- gsub('people', 'nouns', main_data$Lex_cat)

main_data$Broad_lex <- as.factor(main_data$Broad_lex)
main_data$Lex_cat <- as.factor(main_data$Lex_cat)
```

```{r}
main_data$AoA <- as.numeric(main_data$AoA)
main_data$VSoA <- as.numeric(main_data$VSoA)
main_data$CDS_freq <- as.numeric(main_data$CDS_freq)
main_data$Freq <- as.numeric(main_data$Freq)
main_data<-na.omit(main_data)
```


Целевые переменные - Freq, CDS_freq and AoA


```{r}
cor.test(main_data$Freq, main_data$AoA)

```


```{r}
cor.test(main_data$CDS_freq, main_data$AoA)
```

```{r}
cor.test(main_data$Freq+main_data$CDS_freq, main_data$AoA)
```

Тут я интерпретирую результаты корреляции...

#### Смотрим на Freq

График с категориями

```{r}
linreg1 <- lm(data = main_data, AoA ~ Freq)
summary(linreg1)
main_data$linreg1 <- predict(linreg1)

main_data %>% 
  ggplot(aes(Freq, AoA, color=Lex_cat))+
  geom_point()+
  geom_line(aes(Freq, linreg1), color = "blue")+
  labs(x = "frequency in adult speech",
       y = "age of acquisition",
       title = "Association between frequencies and age")+ scale_colour_discrete("POS/category")
```

График с доверительным интервалом

```{r}
ggplot(data = main_data, aes(x = Freq, y = AoA)) + 
  geom_point() +
  labs(x = "frequency in adult speech",
       y = "age of acquisition",
       title = "Association between frequencies and age") +
  geom_smooth(method=lm)
```

#### Смотрим на CDS_freq

График с категориями

```{r}
linreg2 <- lm(data = main_data, AoA ~ CDS_freq)
summary(linreg2)
main_data$linreg2 <- predict(linreg2)

main_data %>% 
  ggplot(aes(CDS_freq, AoA, color=Lex_cat))+
  geom_point()+
  geom_line(aes(CDS_freq, linreg2), color = "blue")+
  labs(x = "frequency in adult speech",
       y = "age of acquisition",
       title = "Association between frequencies and age")+ scale_colour_discrete("POS/category")
```

График с доверительным интервалом

```{r}
ggplot(data = main_data, aes(x = CDS_freq, y = AoA)) + 
  geom_point() +
  geom_line(aes(CDS_freq, linreg2), color = "blue")+
  labs(x = "frequency in child directed speech",
       y = "age of acquisition",
       title = "Association between frequencies and age") +
  geom_smooth(method=lm)

```

p-value: 0.5253, поэтому нулевую гипотезу не отвергаем

#### Смотрим на обе частотности сразу

График с категориями

```{r}

linreg3 <- lm(data = main_data, AoA ~ Freq + CDS_freq)
main_data$linreg3 <- predict(linreg3)
summary(linreg3)

ggplot(data = main_data, aes(Freq + CDS_freq, AoA, color=Lex_cat))+
  geom_point()+
  geom_line(aes(Freq + CDS_freq, linreg3), color = "blue")+
  labs(x = "frequency in parents' speech",
       y = "age of acquisition",
       title = "Association between frequencies and age")+ scale_colour_discrete("POS/category")
```

График без категорий

```{r}
ggplot(data = main_data, aes(x = CDS_freq + Freq, y = AoA)) + 
  geom_point() +
  labs(x = "frequency in parents' speech",
       y = "age of acquisition",
       title = "Association between frequencies and age") +
  geom_smooth(method=lm)
  
```

Выводы по линейной регрессии и второй гипотезе

```{r}
```

```{r}
main_data <- read_csv('https://raw.githubusercontent.com/wksmirnowa/LDA_project/master/main_data.csv')
main_data$Word_CDI <- as.factor(main_data$Word_CDI)
main_data$Lex_cat <- gsub('action words', 'verbs', main_data$Lex_cat)
main_data$Lex_cat <- gsub('descriptive words', 'adjectives', main_data$Lex_cat)
main_data$Lex_cat <- gsub('closed-class items', 'closedclass', main_data$Lex_cat)

main_data$Lex_cat <- gsub('common nouns', 'nouns', main_data$Lex_cat)
main_data$Lex_cat <- gsub('places to go', 'nouns', main_data$Lex_cat)
main_data$Lex_cat <- gsub('people', 'nouns', main_data$Lex_cat)

main_data$Broad_lex <- as.factor(main_data$Broad_lex)
main_data$Lex_cat <- as.factor(main_data$Lex_cat)
```

```{r}
main_data$AoA <- as.numeric(main_data$AoA)
main_data$VSoA <- as.numeric(main_data$VSoA)
main_data$CDS_freq <- as.numeric(main_data$CDS_freq)
main_data$Freq <- as.numeric(main_data$Freq)
main_data<-na.omit(main_data)
```

```{r}
contrasts(main_data$Lex_cat)
```
```{r}
res <- model.matrix(~Lex_cat, data = main_data)
res <- as.data.frame(res)
bind_cols(main_data, res) -> main_data_model
main_data_model
```

```{r}
library(car)
linreg5 <- lm(AoA ~ Freq + CDS_freq + Lex_catclosedclass + Lex_catverbs + Lex_catnouns + Lex_catadjectives,
             data = main_data_model)
Anova(linreg5)
summary(linreg5)
main_data_model$linreg5 <- predict(linreg5)
```

```{r}
ggplot(data = main_data_model, aes(Freq + CDS_freq + Lex_catclosedclass + Lex_catverbs + Lex_catnouns + Lex_catadjectives, AoA, color=Lex_cat))+
  geom_point()+
  geom_line(aes(Freq + CDS_freq + Lex_catclosedclass + Lex_catverbs + Lex_catnouns + Lex_catadjectives, linreg5), color = "blue")+
  labs(x = "frequency in parents' speech",
       y = "age of acquisition",
       title = "Association between frequencies and age")+ scale_colour_discrete("POS/category")
```

```{r}
ggplot(data = main_data_model, aes(x = Freq + CDS_freq + Lex_catclosedclass + Lex_catverbs + Lex_catnouns + Lex_catadjectives, y = AoA)) + 
  geom_point() +
  labs(x = "frequency in parents' speech",
       y = "age of acquisition",
       title = "Association between frequencies and age") +
  geom_smooth(method=lm)
  
```
```{r}

```
```{r}
```
```{r}

```
```{r}

```
```{r}

```
```{r}
```
```{r}

```
```{r}

```
```{r}

```
```{r}
```
```{r}

```
```{r}

```
```{r}

```
```{r}
```
```{r}

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
