---
title: "WORD ACQUISITION OF INFANTS AND TODDLERS"
output: html_document
---
## Hypotheses

This study has 2 hypotheses to prove. 

First of them is that children memorize words of closed class after acquisition of particular amount of words from opened class. In this paper we tried to prove that toddlers assimilate nouns earlier than verbs and adjectives, when closed class items are scarcer in their speech.

The author could also expect that frequency of each category in child directed speech and adults’ speech have linear negative association with age of acquisition of each word class. The general idea of the connection between these factors is that frequencies of each reproduced group of words could be the highest when children are the youngest. During their growing up children commence to remember and reproduce rarer classes of words. It is the second hypothesis of the study hereto.

## Description of the data

### Data collection method

The main data consists of 732 words included in the Norwegian adaptation of MacArthur-Bates Communicative Development Inventories (abbreviated as "CDI") form, a parental questionnaire demonstrated to give a valid and reliable measure of early lexical development. The Norwegian CDI norms consist of averaged data from 6500 monolingual Norwegian children. Important thing about CDI: their norms are typically cross-sectional and can thus not be used to determine when each child acquired each word, only which words she or he currently produces (or understands). This limitation was circumvented by calculating the age in months where at least 50% of the children are reported to produce each word. It is commonly referred to the data as a word’s age of acquisition. 

This data was collected by Pernille Hansen, PhD in linguistics at MultiLing, University of Oslo.

### Description of the data

The dataset includes two files. The main table consists of information about 732 Norwegian words with translation into English, average age of acquisition of each word, average vocabulary size reproduced by children, lexical and broad lexical categories of each word and frequencies of words in the Norwegian Web Corpus and child-directed speech (abbreviated as "CDS"). The "Norwegian CDS frequency" table replicates some columns from main data. The second table includes measures of how frequently each word is used in Norwegian both on the internet (as observed in the Norwegian Web as Corpus dataset) and when an adult is talking to a child.

### Main data columns

* __ID_CDI_I__ (ID in the Norwegian CDI I (Kristoffersen et al. 2012));

* __ID_CDI_II__ (ID in the Norwegian CDI II (Kristoffersen et al. 2012));

* __Word_NW__ (Entry as given in the database Norwegian Words (Lind et al, 2015));

* __Word_CDI__ (Entry as given in the CDI (Kristoffersen et al. 2012));

* __Translation__ (English translation of each word);

* __AoA__ (Age of acquisition: the age (in months) where 50% of the norming sample of children (Simonsen et al., 2014) are reported to produce the word);

* __VSoA__ (Vocabulary size of acquisition: the vocabulary size (in spans of 20 words) where 50% of the norming sample of children (Simonsen et al., 2014) are reported to produce the word);

* __Lex_cat__ (Lexical category as given by Kristoffersen et al. (2012));

* __Broad_lex__ (Broad lexical category based on Bates et al. (1994));

* __Freq__ (Frequency in the corpus Norwegian Web as Corpus (NoWaC) (Guevara 2010), taken to approximate frequency in adult speech);

* __CDS_freq__ (Frequency in child-directed speech based Simonsen (1990) and Garmann-Norwegian (Garmann, 2016; Garmann et al., in press)).

### Main factors

In the current dataset nouns are named as *common nouns*, *places to go*, *people* (in __Lex_cat__) and *nominals* (in __Broad_lex__). Some nouns are included in *games&routines* (both in __Lex_cat__ and __Broad_lex__), which also consists of interjections ('ja' = 'yes', 'nei' = 'no','hallo' = 'hello'), verbs ('vent' = 'wait') and constructions ('gå på do' = 'go to the bathroom', 'god natt' = 'good night'). 

As a broad category, *nominals* comprise some interjections as *sound effects*(in __Lex_cat__).

Most of all verbs are placed into *action words* category (in __Lex_cat__) and *predicates* (in __Broad_lex__). Furthermore, it is important to notice that adjectives are included in *predicates* (in __Broad_lex__) group, but they are named as *descriptive words* (in __Lex_cat__).

Closed class words are represented in *closed-class items* (in __Lex_cat__), or *closed-class* (in __Broad_lex__).

There appears to be *temporal* category which is not identified in the main data ('#N/A' category). It is composed of temporal nouns, prepositions and adverbs such as 'formiddag' =  'morning', 'nå' = 'now' and 'senere' = 'later'.

According to this information, the author decided to analyze *common nouns*, *places to go* and *people* as nouns, *action words* as verbs, *descriptive words* as adjectives and *closed-class* as closed class words. The reason of this choice is that mixed categories are able to confuse models and results. Additional relevant factors for the paper are frequencies of words in adults’ speech and CDS.

```{r}
#словарик
# outliers - выбросы
# the study hereto - эта работа
# novelty - новизна
# The scope of the study - масштаб, сфера, объем работы

#assume, deny, promise, refuse, suggest
```
```{r}
#кладбище кода

#Если нас интересует конкретная переменная
#fielddata[fielddata$gender == "m",]

#хочу выбрать значение
#asp <- phono[phono$aspiration == "yes", ]

#если я хочу заменить все NA нулями
#age_of_acquisition[is.na(age_of_acquisition)] <- 0
#лучше работает штука из библиотеки imputeTS
#data_4 <- na_replace(data_4, 0)
#Это тоже должно было работать, но не работает
#main_data2<-main_data[complete.cases(main_data),]

# вот так можно удалить все слова со значениями NA
#age_of_acquisition <- as.numeric(main_data$AoA)
#age_of_acquisition <- age_of_acquisition[!is.na(age_of_acquisition)]
#vocsize_of_acquisition <- as.numeric(main_data$VSoA)
#vocsize_of_acquisition <- vocsize_of_acquisition[!is.na(vocsize_of_acquisition)]
#CDSfreq <- as.numeric(main_data$CDS_freq)
#CDSfreq <- CDSfreq[!is.na(CDSfreq)]
#freq <- as.numeric(main_data$Freq)
#freq <- freq[!is.na(freq)]

#если я хочу найти, где конкретные значения в данных
#which(grepl('#N/A', main_data$Lex_cat))


#боксплоты про vocabulary size не нужны
#boxplot(main_data$VSoA ~ main_data$Lex_cat,
#        main = "Vocabulary size of acquisition ~ lexical category",
#        xlab = "lexical category",
#        ylab = "vocabulary size",
#        col = "lavender",
#        border = "brown")
#boxplot(vocsize_of_acquisition,
#         main = "Vocabulary size of acquisition: outliers",
#        ylab = "vocabulary size",
#        col = "lavender",
#        border = "brown")
#boxplot(main_data$VSoA ~ main_data$Broad_lex,
#        main = "Vocabulary size of acquisition ~ broad lexical category",
#        xlab = "broad lex category",
#        ylab = "vocabulary size",
#        col = "lavender",
#        border = "brown")

#еще боксплоты vocabulary size
#p <- ggplot(main_data, aes(main_data$Lex_cat, main_data$VSoA, color=main_data$Lex_cat)) 
#p + geom_boxplot() + facet_wrap(~main_data$Lex_cat, scale="free") + 
#        labs(title = "Vocabulary size of acquisition ~ lexical category",
#       x = "lexical category",
#       y = "vocabulary size") + scale_colour_discrete("Lexical categories")

#заменяем NA на 0, чтобы сохранить все слова, и таблица 
#main_data$AoA <- as.numeric(main_data$AoA)
#main_data$AoA <- na_replace(main_data$AoA, 0)
#main_data$VSoA <- as.numeric(main_data$VSoA)
#main_data$VSoA <- na_replace(main_data$VSoA, 0)
#main_data$CDS_freq <- as.numeric(main_data$CDS_freq)
#main_data$CDS_freq <- na_replace(main_data$CDS_freq, 0)
#main_data$Freq <- as.numeric(main_data$Freq)
#main_data$Freq <- na_replace(main_data$Freq, 0)

#удаляем данные с NA
#main_data$AoA <- as.numeric(main_data$AoA)
#main_data$AoA <- na_remove(main_data$AoA)
#main_data$VSoA <- as.numeric(main_data$VSoA)
#main_data$VSoA <- na_remove(main_data$VSoA)
#main_data$CDS_freq <- as.numeric(main_data$CDS_freq)
#main_data$CDS_freq <- na_remove(main_data$CDS_freq)
#main_data$Freq <- as.numeric(main_data$Freq)
#main_data$Freq <- na_remove(main_data$Freq)
#main_data <- na_remove(main_data)

#несработавшие способы объединения
#inner_join(common_nouns, places_to_go, by=c("Lex_cat"))

#merge(x = common_nouns, y = places_to_go, by = "Lex_cat", all = TRUE) -> nouns_1
#merge(x = nouns_1, y = people, by = "Lex_cat", all = TRUE) -> nouns
#nouns <- na.omit(nouns)
```

```{r}
#отдельный кусок кладбища
#Теперь надо удалить все значения NA, чтобы не рушить статистику
#age_of_acquisition <- as.numeric(main_data$AoA)
#age_of_acquisition <- age_of_acquisition[!is.na(age_of_acquisition)]
#vocsize_of_acquisition <- as.numeric(main_data$VSoA)
#vocsize_of_acquisition <- vocsize_of_acquisition[!is.na(vocsize_of_acquisition)]
#CDSfreq <- as.numeric(main_data$CDS_freq)
#CDSfreq <- CDSfreq[!is.na(CDSfreq)]
#freq <- as.numeric(main_data$Freq)
#freq <- freq[!is.na(freq)]

#boxplot(age_of_acquisition, 
#        main = "Age of acquisition: outliers",
#        ylab = "age",
#        col = "pink",
#        border = "brown")

#ANOVA with multiple groups:
#res <- aov(phono$vowel.dur ~ phono$cons1 + phono$roundness)
#res
```

```{r}
#лишний граф
#pd <- position_dodge(0.1)
#ggplot(target_cats, aes(x=Lex_cat, y=AoA, colour=Lex_cat, group=Lex_cat)) + 
#    geom_errorbar(aes(ymin=AoAymin, ymax=AoAymax), colour="black", width=.1, position=pd) +
#    geom_line(position=pd) +
#    geom_point(position=pd, size=3, shape=21, fill="white") + # 21 is filled circle
#    xlab("Lexical categories") +
#    ylab("Age in months") +
#    scale_colour_hue(name="Lexical categories",
#                     breaks=c("AW", "CC", "CN", "DW", "P", "PTG")) +
#    ggtitle("Between-group variance of influence on children lex. categories\' acquisition")

#aov.data <- aov(data$acuracia ~ data$metodo, data=data)
#anova(categories_acquisition)
#tky <- TukeyHSD(aov.data, "data$metodo");
#png("pertubacao-metodo.png",width=320,height=480)
#plot(tky)
#plot(TukeyHSD(categories_acquisition, "tension"), ylab="")

#target_cats %>% mutate(AoAymin=AoA-(AoA*0.95)) -> target_cats
#target_cats %>% mutate(AoAymax=AoA+(AoA*0.95)) -> target_cats
```

```{r}
#install.packages('tidyverse')
#install.packages('imputeTS')
install.packages('sciplot')
```

```{r, echo=FALSE}
library(tidyverse)
library(imputeTS)
library(ggplot2)
library(dplyr)
#library(sciplot)
main_data <- read_csv('main_data.csv')
norwegian <- read_csv('Norwegian_CDS_frequency.csv')
#View(main_data)
#View(norwegian)
```
## Preprocessing

The data have missing values. First, we should rename them in lexical categories, where '#N/A' string is located in rows with temporal nouns and prepositions, for instance, 'morgen' ('morning'), 'før' ('before').

```{r}
# заменяем NA там, где категория почему-то не указана
main_data$Lex_cat <- gsub('#N/A', 'temporal', main_data$Lex_cat)
main_data$Lex_cat <- as.factor(main_data$Lex_cat)
main_data$Broad_lex <- gsub('#N/A', 'temporal', main_data$Broad_lex)
main_data$Broad_lex <- as.factor(main_data$Broad_lex)
main_data$Word_CDI <- as.factor(main_data$Word_CDI)
```

```{r}
#удаляем данные с NA
main_data$AoA <- as.numeric(main_data$AoA)
main_data$VSoA <- as.numeric(main_data$VSoA)
main_data$CDS_freq <- as.numeric(main_data$CDS_freq)
main_data$Freq <- as.numeric(main_data$Freq)
main_data<-na.omit(main_data)
```

```{r}
main_data %>%
ggplot(aes(Broad_lex, fill=Broad_lex))+geom_bar()+
        labs(title = "Broad lexical categories: amount of words",
             x = "broad lexical category")+scale_fill_discrete("Broad lexical categories")+
        theme_update(plot.title = element_text(hjust = 1.0))
```


```{r}
main_data %>%
ggplot(aes(Lex_cat, fill=Lex_cat))+geom_bar()+
        labs(title = "Lexical categories: amount of words",
             x = "lexical category")+scale_fill_discrete("Lexical categories")
```
Посмотрим наличие выбросов

```{r}
length(boxplot(main_data$AoA ~ main_data$Broad_lex, 
        main = "Age of acquisition ~ broad lexical category",
        xlab = "broad lexical category",
        ylab = "age in months",
        col = "pink",
        border = "brown")$out)

```

```{r}
length(boxplot(main_data$AoA ~ main_data$Lex_cat, 
        main = "Age of acquisition ~ lexical category",
        xlab = "lexical category",
        ylab = "age in months",
        col = "pink",
        border = "brown")$out)

```

```{r}
p <- ggplot(main_data, aes(Broad_lex, AoA, color=Broad_lex)) 
p + geom_boxplot() + facet_wrap(~Broad_lex, scale="free") + 
        labs(title = "Age of acquisition ~ broad lexical category",
       x = "broad lex. category",
       y = "age in months") + scale_colour_discrete("Lexical categories")
```

```{r}
p <- ggplot(main_data, aes(Lex_cat, AoA, color=Lex_cat)) 
p + geom_boxplot() + facet_wrap(~Lex_cat, scale="free") + 
        labs(title = "Age of acquisition ~ lexical category",
       x = "lexical category",
       y = "age in months") + scale_colour_discrete("Lexical categories")
```

```{r}
ggplot(data = main_data, aes(x = Word_CDI, y = AoA, col=Broad_lex)) + 
  geom_point() +
  labs(x = "words",
       y = "age in months",
       title = "Words")+scale_colour_discrete("Broad lex categories")
```

```{r}
ggplot(data = main_data, aes(x = Word_CDI, y = AoA, col=Lex_cat)) + 
  geom_point() +
  labs(x = "words",
       y = "age in months",
       title = "Words")+scale_colour_discrete("Lexical categories")
```

```{r}
ggplot(data = main_data, aes(x = Broad_lex, y = AoA, col=Broad_lex)) + 
  geom_point() +
  labs(x = "broad lexical category",
       y = "age in months",
       title = "Words")+scale_colour_discrete("Broad lexical categories")
```
```{r}
ggplot(data = main_data, aes(x = Lex_cat, y = AoA, col=Lex_cat)) + 
  geom_point() +
  labs(x = "lexical category",
       y = "age in months",
       title = "Words")+ scale_colour_discrete("Lexical categories")
```

## Statistical hypotheses to prove

The main hypotheses of the piece of research are that children commence to reproduce words of closed class after acquisition of nouns, verbs and adjectives and frequency of words in child directed speech and adults’ speech within some classes have strong correlation with age of acquisition.

* __H0__: mean ages of acquisition of different classes are similar.
* __H1__: mean ages of acquisition of different classes have variations.

* __H0__: there appears to be no correlation/no linear negative association between frequencies of categories in parents’ speech and age of words' acquisition, the true correlation coefficient R is 0.
* __H1__: there appears to be correlation/linear negative association between frequencies of categories in parents’ speech and age of words' acquisition, the true correlation coefficient R is not 0.

## Statistical tools and methods

Выбрала Анову, так как она может показать, есть ли взаимосвязь между возрастом и словами из разных лексических категорий, а также построю линейную регрессию

Можно выбрать параметрический коэффициент r Пирсона, поскольку у нас мало выбросов, но также можно применить непараметрический коэффициент корреляции Спирмена и сравнить, что получится

Для линейной регрессии выберем Rквадрат (коэффициент детерминации)
(какой коэффициент корреляции выбрать?)

Факторов у нас в целом не так много, поэтому проблем переобучения нет, и потребности в критериях Акаике и Байесовского информационного тоже не возникает

Этот кусок, чтобы не потеряться, потом выкину

According to this information, the author decided to analyze *common nouns*, *places to go* and *people* as nouns, *action words* as verbs, *descriptive words* as adjectives and *closed-class* as closed class words. The reason of this choice is that mixed categories are able to confuse models and results. Additional relevant factors for the paper are frequencies of words in adults’ speech and CDS.

```{r}
main_data %>% filter(Lex_cat=="action words")-> verbs
main_data %>% filter(Lex_cat=="descriptive words")-> adjectives
main_data %>% filter(Broad_lex=="closed-class")-> closedclass

main_data %>% filter(Lex_cat=="common nouns")-> common_nouns
main_data %>% filter(Lex_cat=="places to go")-> places_to_go
main_data %>% filter(Lex_cat=="people")-> people

bind_rows(common_nouns, places_to_go, people) -> nouns
bind_rows(nouns, verbs, adjectives, closedclass) -> target_cats

target_cats
```

If the p-value is less than our significance level, we reject the null hypothesis i.e. F statistics is 0.
If the p-value for F statistics is less than our significance level, we reject the null hypothesis.
p-value > 0.05
```{r}
categories_acquisition <- aov(target_cats$AoA ~ target_cats$Lex_cat)
categories_acquisition
summary(categories_acquisition)
```

The p-value for F statistics is less than our significance level, so we reject the null hypothesis. Mean ages of acquisition of different classes are not the same.

```{r}
tukey <- TukeyHSD(x=categories_acquisition, conf.level=0.95)
tukey
```
```{r}
plot(tukey , las=1 , col="brown")
```

Чисто статистически получается так, что есть различия в том, в каком возрасте дети учат те или иные слова.
```{r}
# заменяем NA там, где категория почему-то не указана
main_data$Lex_cat <- gsub('#N/A', 'temporal', main_data$Lex_cat)
main_data$Broad_lex <- gsub('#N/A', 'temporal', main_data$Broad_lex)
main_data$Word_CDI <- as.factor(main_data$Word_CDI)
main_data$Lex_cat <- gsub('action words', 'verbs', main_data$Lex_cat)
main_data$Lex_cat <- gsub('descriptive words', 'adjectives', main_data$Lex_cat)
main_data$Lex_cat <- gsub('closed-class items', 'closedclass', main_data$Lex_cat)

main_data$Lex_cat <- gsub('common nouns', 'nouns', main_data$Lex_cat)
main_data$Lex_cat <- gsub('places to go', 'nouns', main_data$Lex_cat)
main_data$Lex_cat <- gsub('people', 'nouns', main_data$Lex_cat)

main_data$Broad_lex <- as.factor(main_data$Broad_lex)
main_data$Lex_cat <- as.factor(main_data$Lex_cat)
```

```{r}
#удаляем данные с NA
main_data$AoA <- as.numeric(main_data$AoA)
main_data$VSoA <- as.numeric(main_data$VSoA)
main_data$CDS_freq <- as.numeric(main_data$CDS_freq)
main_data$Freq <- as.numeric(main_data$Freq)
main_data<-na.omit(main_data)
```

```{r}
main_data %>% filter(Lex_cat=="verbs")-> verbs
main_data %>% filter(Lex_cat=="adjectives")-> adjectives
main_data %>% filter(Broad_lex=="closedclass")-> closedclass

main_data %>% filter(Lex_cat=="nouns")-> nouns

bind_rows(nouns, verbs, adjectives, closedclass) -> target_cats_new

target_cats_new
```

```{r}
categories_acquisition <- aov(target_cats_new$AoA ~ target_cats_new$Lex_cat)
categories_acquisition
summary(categories_acquisition)
```

The p-value for F statistics is still less than our significance level, so we reject the null hypothesis again. Mean ages of acquisition of different classes are not the same.

```{r}
tukey <- TukeyHSD(x=categories_acquisition, conf.level=0.95)
tukey
```
```{r}
plot(tukey , las=1 , col="brown")
```
```{r}

```
```{r}

```
```{r}

```
```{r}

```
```{r}

```
```{r}

```
```{r}

```
```{r}
```
```{r}

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
